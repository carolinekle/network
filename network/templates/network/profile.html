{% extends "network/layout.html" %}
{% block body %}


    <h2 class="mx-3">{{ profile.username }}</h2>

    <br>
    <div class="d-flex justify-content-around ">
        <h4>Following: {{ following.count }}</h4>
        <h4>Followers:  <span  id="follower-count">{{ followers.count }}</span></h4>
    </div>
    {%if user.is_authenticated%}
    {%if post.poster == user %}

    {%else%}
    <button type="submit"class=" ml-3 btn btn-primary" id="follow" value= {{ profile.username }}>Follow</button>
    {% endif %}
    {%else%}
    <div class = "ml-3">Sign in or sign up to like posts and follow your friends!</div>
    {%endif%}
    <br>

    {% for post in page_obj %}
    <div class="mx-3 my-3 d-flex flex-column post post_{{post.id}}">
        <a href="{% url 'profile' post.poster %}"><h4>{{ post.poster }}</h4></a>
        <p id ="content_{{ post.id }}">{{ post.text }}</p>
        <small>{{ post.created }}</small>
        <small class="edited_{{ post.id }}">
          {% if post.updated %}
          Updated on: {{post.updated|date:'M d, Y, h:i a' }}
          {% endif %}
        </small>
        {% if post.poster == user %}
        <div class="flex-row">
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#edited_{{ post.id }}">Edit</button>
            <button type="button" class="btn btn-primary">Delete Post</button>
            
        
        


        <div class="modal" id="edited_{{ post.id }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document" style="z-index: 3000 !important;">
              <div class="modal-content" style="z-index: 3000 !important;">
                  <div class="modal-header" style="z-index: 3000 !important;">
                      <h5 style="z-index: 3000 !important;"class="modal-title" id="exampleModalLongTitle">{{ post.poster }}</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="z-index: 3000 !important;">
                          <span aria-hidden="true">&times;</span>
                      </button>
                  </div>
                  <div class="modal-body" style="z-index: 3000 !important;">
                      <textarea rows="5" style="z-index: 3000 !important;" class="modal-body" id="new_text">{{ post.text }}</textarea>
                  </div>
                  <div class="modal-footer" style="position: relative; z-index: 3500 !important;">
                      <button style="z-index: 4000 !important;" type="submit" value="{{ post.id }}" id="edit" class="btn btn-primary">Save Changes</button>
                  </div>
              </div>
          </div>
      </div>
    </div>

        {% endif %}

        {%if user.is_authenticated %}
        <div class = "mt-1 d-flex"> 
            <div value={{post.id}} class='d-flex flex-column mr-2 like_{{ post.id }}' id="like" data-post-id="{{ post.id }}">
                <ion-icon class = "heart_{{ post.id }}" name="heart" size="small">
                  <div class='red-bg'></div>
                </ion-icon>
              </div>
              {%endif%}
          <span value = {{post.likes}} class = "like_count_{{post.id}}">{{ post.likes }} </span>
        </div>

        <div>
        </div>
    </div>

 {% endfor %}


    <div class="pagination d-flex justify-content-center my-2">
        <span class="step-links">
            {% if page_obj.has_previous %}
                <a href="?page=1">&laquo; First</a>
                <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
            {% endif %}
    
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}">Next</a>
                <a href="?page={{ page_obj.paginator.num_pages }}">Last &raquo;</a>
        {% endif %}
        </span>
    </div>


{% endblock %}